<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Torypto | Kripto Sinyal Platformu</title>
    
    <!-- Fontlar -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Select2 -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

    <!-- TradingView -->
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <style>
        :root {
            --primary: #00ff88;
            --primary-dark: #00cc6a;
            --secondary: #7000ff;
            --bg-dark: #0a0b0e;
            --bg-card: #151720;
            --text-primary: #ffffff;
            --text-secondary: #8a8d93;
            --success: #00ff88;
            --warning: #ffbb00;
            --danger: #ff3366;
            --card-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            --gradient: linear-gradient(135deg, rgba(0,255,136,0.1), rgba(112,0,255,0.1));
        }

        * {
            margin: 0; 
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
        }

        /* Header Styles */
        .header {
            background: rgba(21, 23, 32, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem 2rem;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1440px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary);
            text-decoration: none;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        /* Main Content */
        .main-content {
            margin-top: 80px;
            padding: 2rem;
            max-width: 1440px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Pair Selector Card */
        .pair-selector {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--card-shadow);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Select2 Customization */
        .select2-container {
            width: 100% !important;
        }

        .select2-container--default .select2-selection--single {
            background: rgba(255, 255, 255, 0.05) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            border-radius: 8px !important;
            height: 50px !important;
            display: flex !important;
            align-items: center !important;
        }

        .select2-container--default .select2-selection--single .select2-selection__rendered {
            color: var(--text-primary) !important;
            line-height: 50px !important;
            padding-left: 1rem !important;
        }

        /* Signal Cards */
        .signal-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .signal-card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: var(--card-shadow);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease;
        }

        .signal-card:hover {
            transform: translateY(-5px);
        }

        .signal-card.buy {
            border-left: 4px solid var(--success);
        }

        .signal-card.sell {
            border-left: 4px solid var(--danger);
        }

        .signal-card.hold {
            border-left: 4px solid var(--warning);
        }

        /* Buttons */
        .btn {
            background: var(--gradient);
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 8px;
            color: var(--text-primary);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(4px);
        }

        .btn-primary {
            background: var(--primary);
            color: var(--bg-dark);
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        /* TradingView Container */
        .tradingview-container {
            width: 100%;
            height: 700px !important;
            margin: 2rem 0;
            background: var(--bg-card);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--card-shadow);
            overflow: hidden;
            position: relative;
        }

        #tradingview_chart {
            width: 100% !important;
            height: 100% !important;
            position: absolute !important;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
        }

        /* TradingView widget'ı için özel stiller */
        .tradingview-widget-container {
            background: var(--bg-card) !important;
        }

        /* Footer */
        .footer {
            background: linear-gradient(to bottom, transparent, var(--bg-card));
            padding: 3rem 2rem;
            text-align: left;
            color: var(--text-secondary);
            font-size: 0.8rem;
            margin-top: 4rem;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }

        .footer h3 {
            color: var(--primary);
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.9;
        }

        .footer p {
            max-width: 900px;
            margin: 0 auto;
            line-height: 1.6;
            opacity: 0.7;
        }

        .footer-content {
            max-width: 1440px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Footer responsive */
        @media (max-width: 768px) {
            .footer {
                padding: 2rem 1rem;
            }
            
            .footer h3 {
                font-size: 0.85rem;
            }
            
            .footer p {
                font-size: 0.75rem;
            }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header {
                padding: 1rem;
            }

            .main-content {
                padding: 1rem;
            }

            .signal-cards {
                grid-template-columns: 1fr;
            }

            .tradingview-container {
                height: 500px !important;
            }
        }

        /* Preloader Styles */
        #preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 11, 14, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            backdrop-filter: blur(5px);
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid var(--text-secondary);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Select2 Dark Theme Fixes */
        .select2-container--default .select2-selection--single {
            background: var(--bg-card) !important;
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
        }

        .select2-dropdown {
            background: var(--bg-card) !important;
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
            border-radius: 8px !important;
            margin-top: 4px;
            box-shadow: var(--card-shadow);
        }

        .select2-search--dropdown {
            padding: 10px !important;
            background: rgba(255, 255, 255, 0.02);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .select2-search__field {
            background: rgba(255, 255, 255, 0.05) !important;
            color: var(--text-primary) !important;
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
            border-radius: 6px !important;
            padding: 8px 12px !important;
            font-size: 0.95rem !important;
            transition: all 0.3s ease;
            width: 100% !important;
        }

        .select2-search__field:focus {
            outline: none !important;
            border-color: var(--primary) !important;
            background: rgba(255, 255, 255, 0.08) !important;
            box-shadow: 0 0 0 2px rgba(0, 255, 136, 0.1);
        }

        .select2-search__field::placeholder {
            color: var(--text-secondary);
            opacity: 0.7;
        }

        .select2-results__option {
            color: var(--text-primary) !important;
            padding: 12px 16px !important;
            border-radius: 4px;
            margin: 2px 6px;
            transition: all 0.2s ease;
        }

        .select2-results__option--highlighted {
            background: var(--primary) !important;
            color: var(--bg-dark) !important;
        }

        .select2-results__options {
            padding: 6px 4px !important;
            max-height: 280px !important;
        }

        .select2-results {
            padding: 4px !important;
        }

        /* Select2 Scrollbar */
        .select2-results__options::-webkit-scrollbar {
            width: 8px;
        }

        .select2-results__options::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }

        .select2-results__options::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }

        .select2-results__options::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Live Price Ticker */
        .live-price-ticker {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .price-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .price-info img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
        }

        .pair-details {
            display: flex;
            flex-direction: column;
        }

        .pair-details h3 {
            margin: 0;
            font-size: 1.2rem;
            color: var(--text-primary);
        }

        .pair-symbol {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .price-container {
            text-align: right;
        }

        .price-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .price-change {
            font-size: 1rem;
            margin-top: 0.25rem;
        }

        .price-change.positive {
            color: var(--success);
        }

        .price-change.negative {
            color: var(--danger);
        }

        /* Analysis Card */
        .analysis-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--card-shadow);
        }

        .analysis-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 1rem;
        }

        .signal-badge {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .signal-icon {
            font-size: 1.2rem;
        }

        .signal-badge.buy {
            background: rgba(0, 255, 136, 0.1);
            color: var(--success);
            border: 1px solid rgba(0, 255, 136, 0.2);
        }

        .signal-badge.sell {
            background: rgba(255, 51, 102, 0.1);
            color: var(--danger);
            border: 1px solid rgba(255, 51, 102, 0.2);
        }

        .signal-badge.hold {
            background: rgba(255, 187, 0, 0.1);
            color: var(--warning);
            border: 1px solid rgba(255, 187, 0, 0.2);
        }

        .analysis-content {
            color: var(--text-primary);
        }

        .short-comment {
            font-size: 1.1rem;
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .detailed-comment {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1rem;
            font-size: 0.9rem;
            line-height: 1.8;
        }

        .show-details-btn {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem;
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.95rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .show-details-btn:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .btn-icon {
            font-size: 0.8rem;
            transition: transform 0.3s ease;
        }

        .show-details-btn[aria-expanded="true"] .btn-icon {
            transform: rotate(180deg);
        }

        /* Signals Table */
        .signals-table {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
            background: var(--bg-card);
            border-radius: 16px;
            overflow: hidden;
        }

        .signals-table th,
        .signals-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .signals-table th {
            background: rgba(255, 255, 255, 0.05);
            font-weight: 500;
            color: var(--text-secondary);
        }

        .signals-table tr:hover {
            background: rgba(255, 255, 255, 0.02);
        }

        /* Form Layout */
        .form-row {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .form-row .select2-container {
            flex: 1;
        }

        .form-row button {
            width: 200px;
        }

        /* Select2 özelleştirmeleri için ek stiller */
        .select2-container--default .select2-selection--single {
            height: 60px !important;
            padding: 15px 10px !important;
        }

        .select2-container--default .select2-selection--single .select2-selection__rendered {
            line-height: 30px !important;
        }

        .select2-container--default .select2-selection--single .select2-selection__arrow {
            height: 58px !important;
        }

        .pair-option {
            display: flex;
            align-items: center;
            padding: 8px;
        }

        .pair-option img {
            width: 24px;
            height: 24px;
            margin-right: 12px;
            border-radius: 50%;
        }

        .pair-info {
            display: flex;
            flex-direction: column;
        }

        .pair-name {
            font-weight: 500;
            color: var(--text-primary);
        }

        .pair-price {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* Live Price Ticker düzenlemeleri */
        .live-price-ticker {
            display: grid;
            grid-template-columns: auto 1fr auto;
            gap: 20px;
            align-items: center;
            padding: 20px;
        }

        .price-info {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 15px;
            align-items: center;
        }

        .price-info img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
        }

        /* Analysis Card düzenlemeleri */
        .analysis-card {
            margin-top: 2rem;
        }

        .analysis-content {
            margin-top: 1rem;
        }

        .short-comment {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .detailed-comment {
            display: none;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            margin-top: 1rem;
        }

        .show-details-btn {
            background: none;
            border: 1px solid var(--primary);
            color: var(--primary);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 1rem;
        }

        .show-details-btn:hover {
            background: rgba(0, 255, 136, 0.1);
        }

        /* Signals Table düzenlemeleri */
        .signals-table td {
            vertical-align: middle;
        }

        .pair-cell {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .pair-cell img {
            width: 24px;
            height: 24px;
            border-radius: 50%;
        }

        .pair-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            object-fit: cover;
        }

        .pair-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px;
        }

        .pair-info {
            display: flex;
            flex-direction: column;
        }

        .pair-name {
            font-weight: 500;
            color: var(--text-primary);
        }

        .pair-price {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* Select2 özelleştirmeleri */
        .select2-container--default .select2-selection--single {
            background-color: var(--bg-card) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
        }

        .select2-dropdown {
            background-color: var(--bg-card) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
        }

        .select2-container--default .select2-results__option--highlighted[aria-selected] {
            background-color: var(--primary) !important;
        }

        /* Signals Table Styles */
        .signals-table .analysis-signal {
            padding: 6px 12px;
            border-radius: 6px;
            font-weight: 500;
            font-size: 0.9rem;
            min-width: 80px;
            display: inline-block;
            text-align: center;
        }

        .signals-table .analysis-signal.buy {
            background: rgba(0, 255, 136, 0.1);
            color: var(--success);
            border: 1px solid rgba(0, 255, 136, 0.2);
        }

        .signals-table .analysis-signal.sell {
            background: rgba(255, 51, 102, 0.1);
            color: var(--danger);
            border: 1px solid rgba(255, 51, 102, 0.2);
        }

        .signals-table .analysis-signal.hold {
            background: rgba(255, 187, 0, 0.1);
            color: var(--warning);
            border: 1px solid rgba(255, 187, 0, 0.2);
        }

        /* Signals Table Hover Effect */
        .signals-table tbody tr:hover {
            background: rgba(255, 255, 255, 0.02);
        }

        .signals-table tbody tr {
            transition: background 0.3s ease;
        }

        /* Analysis Card Styles */
        .analysis-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--card-shadow);
        }

        .analysis-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 1rem;
        }

        /* Özet Analiz Stili */
        .analysis-summary {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .short-comment {
            font-size: 1rem;
            line-height: 1.6;
        }

        /* Detaylı Analiz Stili */
        .timeframe-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 0.5rem;
        }

        .tab-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            padding: 0.5rem 1rem;
            cursor: pointer;
            font-size: 0.9rem;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .tab-btn:hover {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
        }

        .tab-btn.active {
            background: var(--primary);
            color: var(--bg-dark);
        }

        .timeframe-content {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 8px;
            padding: 1.5rem;
        }

        /* İndikatör Grupları */
        .indicator-group {
            margin-bottom: 1.5rem;
            padding: 1rem;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.03);
        }

        .indicator-group h4 {
            color: var(--primary);
            font-size: 0.9rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .indicator-item {
            margin: 0.5rem 0;
            padding-left: 1rem;
            border-left: 2px solid rgba(255, 255, 255, 0.1);
        }

        /* Tablo Stilleri */
        .signals-history {
            margin: 2rem 0;
        }

        .signals-history h2 {
            margin-bottom: 1rem;
            font-size: 1.2rem;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .table-container {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1rem;
            box-shadow: var(--card-shadow);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .empty-state {
            text-align: center;
        }

        .empty-message {
            padding: 2rem;
            color: var(--text-secondary);
        }

        .empty-message span {
            font-size: 2rem;
            display: block;
            margin-bottom: 1rem;
        }

        .empty-message p {
            font-size: 0.9rem;
        }

        /* Analysis Card Styles */
        .analysis-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--card-shadow);
        }

        .analysis-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 1rem;
        }

        /* Özet Analiz Stili */
        .analysis-summary {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .short-comment {
            font-size: 1rem;
            line-height: 1.6;
        }

        /* Detaylı Analiz Stili */
        .show-details-btn {
    width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem;
    border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.95rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .show-details-btn:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .timeframe-content {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1rem;
            font-size: 0.9rem;
            line-height: 1.8;
        }

        /* Signal Badge Styles */
        .signal-badge {
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-weight: 500;
            font-size: 0.9rem;
    display: flex;
    align-items: center;
            gap: 0.5rem;
        }

        .signal-badge.buy {
            background: rgba(0, 255, 136, 0.1);
            color: var(--success);
            border: 1px solid rgba(0, 255, 136, 0.2);
        }

        .signal-badge.sell {
            background: rgba(255, 51, 102, 0.1);
            color: var(--danger);
            border: 1px solid rgba(255, 51, 102, 0.2);
        }

        .signal-badge.hold {
            background: rgba(255, 187, 0, 0.1);
            color: var(--warning);
            border: 1px solid rgba(255, 187, 0, 0.2);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .analysis-card {
                padding: 1rem;
            }
            
            .analysis-summary {
                padding: 1rem;
            }
            
            .timeframe-content {
                padding: 1rem;
                font-size: 0.85rem;
            }
        }

        /* Detaylı yorum içindeki özel stiller */
        .detailed-comment h3 {
            color: var(--primary);
            font-size: 1rem;
            margin: 1.5rem 0 1rem;
        }

        .detailed-comment p {
            margin-bottom: 1rem;
        }

        .detailed-comment ul {
            margin-left: 1rem;
            margin-bottom: 1rem;
        }

        .detailed-comment li {
            margin-bottom: 0.5rem;
        }

        .pair-icon {
            width: 24px;
            height: 24px;
            margin-right: 8px;
            vertical-align: middle;
        }

        .select2-container--default .select2-selection--single {
            background: var(--bg-card) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            border-radius: 8px !important;
            height: 50px !important;
        }

        .select2-dropdown {
            background: var(--bg-card) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
        }

        .select2-container--default .select2-results__option--highlighted[aria-selected] {
            background-color: var(--primary) !important;
            color: var(--bg-dark) !important;
        }

        .select2-container--default .select2-results__option[aria-selected=true] {
            background-color: rgba(0, 255, 136, 0.1) !important;
        }

        .select2-results__option {
            padding: 8px 12px !important;
            color: var(--text-primary) !important;
        }

        .select2-search__field {
            background: rgba(255, 255, 255, 0.05) !important;
            color: var(--text-primary) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="{% url 'signals:trade-signal' %}" class="logo">TORYPTO</a>
            <div class="user-menu">
            {% if user.is_authenticated %}
                    <span class="welcome">{{ user.username }}</span>
                    <a href="{% url 'signals:logout' %}" class="btn">Çıkış</a>
            {% else %}
                    <a href="{% url 'signals:login' %}" class="btn">Giriş</a>
            {% endif %}
        </div>
        </div>
    </header>

    <!-- Preloader -->
    <div id="preloader" style="display: none;">
        <div class="spinner"></div>
        <p>Analiz yapılıyor, lütfen bekleyin...</p>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Pair Selector -->
        <div class="pair-selector">
            <form method="get" action="{% url 'signals:trade-signal' %}" id="analyzeForm">
                <div class="form-row">
                    <select name="pair" id="pair" style="width: 100%;">
                {% for pair in pairs %}
                            <option value="{{ pair.symbol }}" 
                                    {% if pair.symbol == selected_pair %}selected{% endif %}
                                    data-icon="{{ pair.icon.url }}">
                                {{ pair.name }} ({{ pair.symbol }})
                            </option>
                {% endfor %}
            </select>
                    <button type="submit" class="btn btn-primary" id="analyzeBtn">
                        <span class="btn-text">Analiz Yap</span>
                        <div class="btn-loader" style="display: none;"></div>
                    </button>
                </div>
        </form>
</div>

        <!-- Live Price Ticker -->
        <div class="live-price-ticker">
            <div class="price-info">
                {% if selected_pair_info.icon %}
                    <img src="{{ selected_pair_info.icon.url }}" alt="{{ selected_pair_info.name }}" class="pair-icon">
                {% endif %}
                <div class="pair-details">
                    <h3>{{ selected_pair_info.name }}</h3>
                    <span class="pair-symbol">{{ selected_pair }}</span>
            </div>
            </div>
            <div class="price-container">
                <div class="price-value" id="livePriceValue">
                    {% if live_price != "Veri alınamadı" %}
                        ${{ live_price|floatformat:2 }}
                    {% else %}
                        Yükleniyor...
                    {% endif %}
            </div>
                <div class="price-change" id="priceChange"></div>
        </div>
        </div>

        <!-- Current Analysis Card -->
        <div class="analysis-card">
            <div class="analysis-header">
                <h2>Teknik Analiz</h2>
                <div class="signal-badge {{ signal|lower }}">
                    {% if signal == "Buy" %}
                        <span class="signal-icon">💹</span> AL
        {% elif signal == "Sell" %}
                        <span class="signal-icon">📉</span> SAT
                    {% else %}
                        <span class="signal-icon">⏳</span> BEKLE
                    {% endif %}
            </div>
            </div>
            
            <div class="analysis-content">
                <!-- Özet Analiz -->
                <div class="analysis-summary">
                    {% if short_comment %}
                        <p class="short-comment">{{ short_comment|safe }}</p>
        {% else %}
                        <p class="short-comment">⚙️ Analiz yapılıyor, lütfen bekleyin...</p>
                    {% endif %}
            </div>

                <!-- Detaylı Analiz -->
                <div class="analysis-details">
                    {% if detailed_comment %}
                        <button class="show-details-btn" onclick="toggleDetails()">
                            <span class="btn-text">Detaylı Analiz</span>
                            <span class="btn-icon">▼</span>
                        </button>
                        <div class="detailed-comment" style="display: none;">
                            {{ detailed_comment|safe|linebreaks }}
            </div>
                    {% endif %}
            </div>
        </div>
        </div>

        <!-- Previous Signals Table -->
        <div class="signals-history">
            <h2>📊 Geçmiş Sinyaller</h2>
            <div class="table-container">
<table class="signals-table">
    <thead>
        <tr>
            <th>Parite</th>
            <th>Sinyal</th>
                            <th>Fiyat</th>
                            <th>Zaman</th>
        </tr>
    </thead>
   <tbody>
    {% for signal in signals %}
                        <tr>
                            <td>
                                <div class="pair-cell">
                                    <img src="{{ signal.pair_icon }}" alt="{{ signal.pair }}">
                                    <span>{{ signal.pair }}</span>
                                </div>
                            </td>
                            <td>
                                <span class="analysis-signal {{ signal.signal|lower }}">
                                    {% if signal.signal == "Buy" %}
                                        AL
                                    {% elif signal.signal == "Sell" %}
                                        SAT
            {% else %}
                                        BEKLE
            {% endif %}
                                </span>
        </td>
                            <td>${{ signal.price_at_signal|floatformat:2 }}</td>
                            <td>{{ signal.updated_at|timesince }} önce</td>
    </tr>
    {% empty %}
                            <tr class="empty-state">
                                <td colspan="4">
                                    <div class="empty-message">
                                        <span>📈</span>
                                        <p>Henüz sinyal geçmişi bulunmuyor</p>
                                    </div>
                                </td>
    </tr>
    {% endfor %}
</tbody>
</table>
            </div>
        </div>

        <!-- TradingView Chart -->
        <div class="tradingview-container">
            <div id="tradingview_chart" style="width: 100%; height: 100%;"></div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <h3>⚠️ Risk Bildirimi</h3>
            <p>Bu platformda sunulan sinyaller, analizler ve piyasa öngörüleri yalnızca genel bilgilendirme amacı taşımakta olup, hiçbir şekilde yatırım tavsiyesi veya yönlendirmesi niteliğinde değildir. Kripto para ve diğer finansal piyasalar, yüksek volatiliteye sahip olup, ani fiyat dalgalanmalarına maruz kalabilir. Bu nedenle, sunulan veriler geçmiş performanslara dayansa da gelecekteki sonuçları garanti etmez. Kullanıcılar, platformda sağlanan bilgilere dayanarak yatırım yapma kararı almadan önce, kendi araştırmalarını yapmalı ve bağımsız finansal danışmanlardan görüş almalıdır. Platform, sunulan sinyal ve analizlerin doğruluğundan, eksiksizliğinden veya güncelliğinden sorumlu tutulamaz; kullanıcıların bu bilgilere dayanarak yapacağı işlemler sonucunda doğabilecek doğrudan veya dolaylı zararlardan platform geliştiricileri ve operatörleri sorumlu değildir. Tüm yatırım kararları, kullanıcının kendi inisiyatifi ve sorumluluğundadır.</p>
    </div>
    </footer>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <script>
        $(document).ready(function() {
            // Select2 Initialization
            $('#pair').select2({
                templateResult: formatPairOption,
                templateSelection: formatPairOption,
                escapeMarkup: function(m) { return m; }
            });

            // Pair Format Function with Price
            function formatPairOption(pair) {
                if (!pair.id) return pair.text;
                var icon = $(pair.element).data('icon');
                if(!icon) {
                    // Varsayılan ikon yolu
                    icon = '/media/pair_icons/default-coin.png';
                }
                return $('<span><img src="' + icon + '" class="pair-icon" onerror="this.src=\'/media/pair_icons/default-coin.png\'" /> ' + pair.text + '</span>');
            }

            // WebSocket bağlantısı
            let ws;
            let selectedPair = '{{ selected_pair }}';
            let reconnectAttempts = 0;
            const maxReconnectAttempts = 5;

            function connectWebSocket() {
                // WebSocket protokolünü otomatik belirle
                const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
                const ws = new WebSocket(`${protocol}//${window.location.host}/ws/prices/`);

                ws.onopen = function() {
                    console.log('WebSocket bağlantısı kuruldu');
                    reconnectAttempts = 0;
                    
                    // Seçili pariteye abone ol
                    ws.send(JSON.stringify({
                        'type': 'subscribe',
                        'symbol': selectedPair
                    }));
                };

                ws.onmessage = function(e) {
                    const data = JSON.parse(e.data);
                    if (data.type === 'price_update' && data.data[selectedPair]) {
                        updatePrice(data.data[selectedPair]);
                        // Kaynak bilgisini göster
                        console.log(`Fiyat kaynağı: ${data.data.source}`);
                    }
                };

                ws.onclose = function() {
                    console.log('WebSocket bağlantısı kapandı');
                    if (reconnectAttempts < maxReconnectAttempts) {
                        reconnectAttempts++;
                        console.log(`Yeniden bağlanılıyor... (${reconnectAttempts}/${maxReconnectAttempts})`);
                        setTimeout(connectWebSocket, 3000);
                    }
                };

                ws.onerror = function(err) {
                    console.error('WebSocket hatası:', err);
                };

                return ws;
            }

            // İlk bağlantıyı kur
            connectWebSocket();

            // Fiyat güncelleme fonksiyonu
            function updatePrice(newPrice) {
                const priceElement = $('#livePriceValue');
                const oldPrice = parseFloat(priceElement.text().replace('$', ''));
                newPrice = parseFloat(newPrice);
                
                if (isNaN(oldPrice)) {
                    priceElement.text('$' + newPrice.toFixed(2));
                    return;
                }
                
                // Fiyat değişimini animasyonlu göster
                priceElement.css('color', newPrice > oldPrice ? 'var(--success)' : 'var(--danger)');
                priceElement.text('$' + newPrice.toFixed(2));
                
                // 1 saniye sonra rengi normale döndür
                setTimeout(() => priceElement.css('color', 'var(--text-primary)'), 1000);

                // Yüzde değişimi
                const change = ((newPrice - oldPrice) / oldPrice * 100);
                const changeText = change > 0 ? 
                    `↑ +${change.toFixed(2)}%` : 
                    `↓ ${change.toFixed(2)}%`;
                
                $('#priceChange')
                    .attr('class', `price-change ${change > 0 ? 'positive' : 'negative'}`)
                    .text(changeText)
                    .fadeIn(200);
            }

            // Parite değiştiğinde
            $('#pair').on('change', function() {
                if (ws && ws.readyState === WebSocket.OPEN) {
                    // Eski pariteyi unsubscribe
                    ws.send(JSON.stringify({
                        'type': 'unsubscribe',
                        'symbol': selectedPair
                    }));
                    
                    // Yeni pariteye subscribe
                    selectedPair = $(this).val();
                    ws.send(JSON.stringify({
                        'type': 'subscribe',
                        'symbol': selectedPair
                    }));
                }
            });

            // Form Submit Handler
            $('#analyzeForm').on('submit', function() {
                $('#preloader').fadeIn();
            });

            // TradingView Chart
            function initTradingViewWidget() {
                if (window.tvWidget) {
                    window.tvWidget.remove();
                }
                
                window.tvWidget = new TradingView.widget({
                    "width": "100%",
                    "height": "100%",
                    "symbol": "BINANCE:{{ selected_pair }}",
                    "interval": "240",
                    "timezone": "Europe/Istanbul",
                    "theme": "dark",
                    "style": "8",
                    "locale": "tr",
                    "toolbar_bg": "transparent",
                    "enable_publishing": false,
                    "hide_side_toolbar": true,
                    "allow_symbol_change": true,
                    "hide_top_toolbar": false,
                    "hide_legend": false,
                    "save_image": true,
                    "container_id": "tradingview_chart",
                    "autosize": true,
                    "studies": [
                        "RSI@tv-basicstudies",
                        "MACD@tv-basicstudies",
                        "BB@tv-basicstudies"
                    ],
                    "theme": "dark",
                    "overrides": {
                        "paneProperties.background": "#131722",
                        "paneProperties.vertGridProperties.color": "#363c4e",
                        "paneProperties.horzGridProperties.color": "#363c4e",
                        "symbolWatermarkProperties.transparency": 90,
                        "scalesProperties.textColor": "#AAA"
                    }
                });
            }

            // Sayfa yüklendiğinde grafiği başlat
            $(document).ready(function() {
                setTimeout(initTradingViewWidget, 100); // Kısa bir gecikme ekle
            });

            // Pencere boyutu değiştiğinde grafiği yeniden boyutlandır
            $(window).resize(function() {
                if (window.tvWidget) {
                    window.tvWidget.resize();
                }
            });
        });

        // Detay göster/gizle ve tab fonksiyonları
        document.addEventListener('DOMContentLoaded', function() {
            // Tab işlevselliği
            const tabBtns = document.querySelectorAll('.tab-btn');
            const timeframeContent = document.querySelector('.timeframe-content');
            
            tabBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    // Aktif tab'ı güncelle
                    tabBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    // İlgili zaman dilimi içeriğini göster
                    const timeframe = btn.dataset.timeframe;
                    const content = timeframeContent.innerHTML;
                    
                    // İçeriği filtrele ve göster
                    const sections = content.split('\n\n');
                    const filteredContent = sections.filter(section => 
                        section.includes(timeframe === '1h' ? 'Kısa Vadeli' :
                                       timeframe === '4h' ? 'Orta Vadeli' : 'Uzun Vadeli')
                    );
                    
                    timeframeContent.innerHTML = filteredContent.join('\n\n');
                });
            });
        });

        function toggleDetails() {
            const detailedComment = $('.detailed-comment');
            const btn = $('.show-details-btn');
            const btnText = btn.find('.btn-text');
            const btnIcon = btn.find('.btn-icon');
            
            if (detailedComment.is(':visible')) {
                detailedComment.slideUp();
                btnText.text('Detaylı Analiz');
                btnIcon.text('▼');
            } else {
                detailedComment.slideDown();
                btnText.text('Analizi Gizle');
                btnIcon.text('▲');
            }
        }
    </script>
</body>
</html>
